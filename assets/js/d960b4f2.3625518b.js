"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[874],{4990:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>u,frontMatter:()=>i,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"query-filter","title":"Query Filters","description":"- Query filters l\xe0 m\u1ed9t object \u0111\u1ec3 l\u1ecdc nh\u1eefng query \u0111ang c\xf3 trong cache theo nh\u1eefng \u0111i\u1ec1u ki\u1ec7n nh\u1ea5t \u0111\u1ecbnh.","source":"@site/docs/query-filter.md","sourceDirName":".","slug":"/query-filter","permalink":"/react-query/query-filter","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"M\u1ed9t s\u1ed1 v\xed d\u1ee5","permalink":"/react-query/example"},"next":{"title":"C\u1ea5u h\xecnh chung cho QueryClient","permalink":"/react-query/common-query-client-config"}}');var c=r(4848),s=r(8453);const i={sidebar_position:9},d="Query Filters",o={},h=[{value:"C\xfa ph\xe1p",id:"c\xfa-ph\xe1p",level:2},{value:"V\xed d\u1ee5",id:"v\xed-d\u1ee5",level:2}];function l(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"query-filters",children:"Query Filters"})}),"\n",(0,c.jsx)(n.admonition,{type:"info",children:(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Query filters l\xe0 m\u1ed9t object \u0111\u1ec3 l\u1ecdc nh\u1eefng query \u0111ang c\xf3 trong cache theo nh\u1eefng \u0111i\u1ec1u ki\u1ec7n nh\u1ea5t \u0111\u1ecbnh."}),"\n",(0,c.jsx)(n.li,{children:"Th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong c\xe1c h\xe0m queryClient, hooks,..."}),"\n"]})}),"\n",(0,c.jsx)(n.h2,{id:"c\xfa-ph\xe1p",children:"C\xfa ph\xe1p"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-ts",children:"{queryKey?: QueryKey, exact?: boolean, predicate?: (query: Query) => boolean, type?: 'active' | 'inactive' | 'all', stale?: boolean}\n"})}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Config"}),(0,c.jsx)(n.th,{children:"Type"}),(0,c.jsx)(n.th,{children:"Description"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"queryKey"})}),(0,c.jsx)(n.td,{children:"Array"}),(0,c.jsxs)(n.td,{children:["Ch\u1ec9 \u0111\u1ecbnh nh\u1eefng queries c\xf3 ",(0,c.jsx)(n.code,{children:"queryKey"})," t\u01b0\u01a1ng \u0111\u1ed1i kh\u1edbp v\u1edbi ",(0,c.jsx)(n.code,{children:"queryKey"})," ta ch\u1ec9 \u0111\u1ecbnh"]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"exact"})}),(0,c.jsx)(n.td,{children:"Boolean"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"true"}),": l\u1ecdc\xa0nh\u1eefng queries c\xf3 ",(0,c.jsx)(n.code,{children:"queryKey"})," kh\u1edbp ch\xednh x\xe1c tuy\u1ec7t \u0111\u1ed1i v\u1edbi ",(0,c.jsx)(n.code,{children:"queryKey"})," ta ch\u1ec9 \u0111\u1ecbnh"]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"predicate"})}),(0,c.jsx)(n.td,{children:"Function"}),(0,c.jsxs)(n.td,{children:["L\xe0 m\u1ed9t h\xe0m ",(0,c.jsx)(n.code,{children:"return Boolean  "}),"ch\u1ec9 \u0111\u1ecbnh nh\u1eefng queries n\xe0o th\u1ecfa m\xe3n \u0111i\u1ec1u ki\u1ec7n."]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"type"})}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"'active'"})," |\xa0",(0,c.jsx)(n.code,{children:"'inactive'"})," |\xa0",(0,c.jsx)(n.code,{children:"'all'"})]}),(0,c.jsxs)(n.td,{children:["Gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh l\xe0 ",(0,c.jsx)(n.code,{children:"'all'"}),(0,c.jsx)("br",{}),"Khi c\xf3 gi\xe1 tr\u1ecb l\xe0 ",(0,c.jsx)(n.code,{children:"'active'"}),", ch\u1ec9 nh\u1eefng active queries s\u1ebd \u0111\u01b0\u1ee3c ch\u1ecdn",(0,c.jsx)("br",{}),"Khi c\xf3 gi\xe1 tr\u1ecb l\xe0 ",(0,c.jsx)(n.code,{children:"'inactive'"}),", ch\u1ec9 nh\u1eefng inactive queries s\u1ebd \u0111\u01b0\u1ee3c ch\u1ecdn"]})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"stale"})}),(0,c.jsx)(n.td,{children:"Boolean"}),(0,c.jsxs)(n.td,{children:[(0,c.jsx)(n.code,{children:"true"}),": Ch\u1ec9\xa0nh\u1eefng ",(0,c.jsx)(n.a,{href:"./#v%C3%B2ng-%C4%91%E1%BB%9Di-c%E1%BB%A7a-m%E1%BB%99t-query-trong-react-query",children:"stale queries"})," m\u1edbi \u0111\u01b0\u1ee3c ch\u1ecdn",(0,c.jsx)("br",{}),(0,c.jsx)(n.code,{children:"false"}),": Ch\u1ec9 nh\u1eefng ",(0,c.jsx)(n.a,{href:"./#v%C3%B2ng-%C4%91%E1%BB%9Di-c%E1%BB%A7a-m%E1%BB%99t-query-trong-react-query",children:"fresh queries"})," m\u1edbi \u0111\u01b0\u1ee3c ch\u1ecdn"]})]})]})]}),"\n",(0,c.jsx)(n.h2,{id:"v\xed-d\u1ee5",children:"V\xed d\u1ee5"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:"// Refetch l\u1ea1i t\u1ea5t c\u1ea3 c\xe1c query m\xe0 c\xf3 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\xean trong m\u1ea3ng queryKey l\xe0 'todos'\nqueryClient.invalidateQueries({ queryKey: [\"todos\"] });\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["V\u1ec1 ",(0,c.jsx)(n.strong,{children:"query matching"})," . Xem v\xed d\u1ee5 sau \u0111\xe2y:"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-ts",children:'import { useQuery, useQueryClient } from "@tanstack/react-query";\n\n// L\u1ea5y instance QueryClient t\u1eeb context\nconst queryClient = useQueryClient();\n\nqueryClient.invalidateQueries({ queryKey: ["todos"] });\n\n// T\u1ea5t c\u1ea3 2 query sau s\u1ebd b\u1ecb refetch do \u0111\u1ec1u c\xf3 ph\u1ea7n t\u1eed \u0111\u1ea7u ti\xean c\u1ee7a m\u1ea3ng queryKey l\xe0 \'todos\'\nconst todoListQuery = useQuery({\n  queryKey: ["todos"],\n  queryFn: fetchTodoList,\n});\nconst todoListQuery = useQuery({\n  queryKey: ["todos", { page: 1 }],\n  queryFn: fetchTodoList,\n});\n'})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsxs)(n.p,{children:["\u0110\u1ec3 kh\u1eafc ph\u1ee5c v\u1ea5n \u0111\u1ec1 n\xe0y, ta th\xeam ",(0,c.jsx)(n.code,{children:"exact: true"})," trong c\u1ea5u h\xecnh ",(0,c.jsx)(n.code,{children:"invalidateQueries()"}),":"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-ts",children:'queryClient.invalidateQueries({\n  queryKey: ["todos"],\n  exact: true,\n});\n\n// Query d\u01b0\u1edbi \u0111\xe2y s\u1ebd \u0111\u01b0\u1ee3c refetch\nconst todoListQuery = useQuery({\n  queryKey: ["todos"],\n  queryFn: fetchTodoList,\n});\n\n// Tuy nhi\xean, query d\u01b0\u1edbi \u0111\xe2y s\u1ebd kh\xf4ng b\u1ecb refetch\nconst todoListQuery = useQuery({\n  queryKey: ["todos", { type: "done" }],\n  queryFn: fetchTodoList,\n});\n'})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Thay v\xec ch\u1ec9 \u0111\u1ecbnh m\u1ed9t ",(0,c.jsx)(n.code,{children:"queryKey"})," c\u1ee5 th\u1ec3 \u0111\u1ec3 refetch, ta c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,c.jsx)(n.code,{children:"predicate"})," trong c\u1ea5u h\xecnh ",(0,c.jsx)(n.code,{children:"invalidateQueries()"})," \u0111\u1ec3 ch\u1ec9 \u0111\u1ecbnh nh\u1eefng query n\xe0o th\u1ecfa m\xe3n \u0111i\u1ec1u ki\u1ec7n m\u1edbi \u0111\u01b0\u1ee3c refetch. V\xed d\u1ee5:"]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-ts",children:'queryClient.invalidateQueries({\n  predicate: (query) =>\n    query.queryKey[0] === "todos" && query.queryKey[1]?.version >= 10,\n});\n\n// Hai query sau s\u1ebd \u0111\u01b0\u1ee3c refetch\nconst todoListQuery = useQuery({\n  queryKey: ["todos", { version: 20 }],\n  queryFn: fetchTodoList,\n});\nconst todoListQuery = useQuery({\n  queryKey: ["todos", { version: 10 }],\n  queryFn: fetchTodoList,\n});\n\n// Tuy nhi\xean, query n\xe0y s\u1ebd kh\xf4ng \u0111\u01b0\u1ee3c refetch do version < 10\nconst todoListQuery = useQuery({\n  queryKey: ["todos", { version: 5 }],\n  queryFn: fetchTodoList,\n});\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>d});var t=r(6540);const c={},s=t.createContext(c);function i(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);