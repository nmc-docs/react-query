"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[184],{4346:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>h,default:()=>u,frontMatter:()=>s,metadata:()=>c,toc:()=>l});const c=JSON.parse('{"id":"infinite-scroll","title":"Infinite scroll v\u1edbi useInfiniteQuery()","description":"Infinite scroll l\xe0 g\xec?","source":"@site/docs/infinite-scroll.md","sourceDirName":".","slug":"/infinite-scroll","permalink":"/react-query/infinite-scroll","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"useMutation()","permalink":"/react-query/useMutation"},"next":{"title":"useQueryClient()","permalink":"/react-query/category/usequeryclient"}}');var i=t(4848),r=t(8453);const s={sidebar_position:6},h="Infinite scroll v\u1edbi useInfiniteQuery()",d={},l=[{value:"Infinite scroll l\xe0 g\xec?",id:"infinite-scroll-l\xe0-g\xec",level:2},{value:"C\xfa ph\xe1p c\u1ee7a useInfiniteQuery()",id:"c\xfa-ph\xe1p-c\u1ee7a-useinfinitequery",level:2},{value:"C\xe1c thu\u1ed9c t\xednh, ph\u01b0\u01a1ng th\u1ee9c tr\u1ea3 v\u1ec1 t\u1eeb useInfiniteQuery()",id:"c\xe1c-thu\u1ed9c-t\xednh-ph\u01b0\u01a1ng-th\u1ee9c-tr\u1ea3-v\u1ec1-t\u1eeb-useinfinitequery",level:2},{value:"C\u1ea5u h\xecnh cho useInfiniteQuery()",id:"c\u1ea5u-h\xecnh-cho-useinfinitequery",level:2},{value:"V\xed d\u1ee5:",id:"v\xed-d\u1ee5",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"infinite-scroll-v\u1edbi-useinfinitequery",children:"Infinite scroll v\u1edbi useInfiniteQuery()"})}),"\n",(0,i.jsx)(n.h2,{id:"infinite-scroll-l\xe0-g\xec",children:"Infinite scroll l\xe0 g\xec?"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Infinite scroll"})," l\xe0 t\xednh n\u0103ng cu\u1ed9n v\xf4 h\u1ea1n. T\u1ee9c l\xe0 cu\u1ed9n trang web \u0111\u1ebfn \u0111\xe2u s\u1ebd hi\u1ec3n th\u1ecb d\u1eef li\u1ec7u \u0111\u1ebfn \u0111\xf3 ch\u1ee9 kh\xf4ng hi\u1ec3n th\u1ecb m\u1ed9t l\xfac h\u1ebft d\u1eef li\u1ec7u. V\xe0 trong react query h\u1ed7 tr\u1ee3 x\u1eed l\xfd t\xednh n\u0103ng n\xe0y v\u1edbi ",(0,i.jsx)(n.code,{children:"useInfiniteQuery()"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"useInfiniteQuery()"})," l\xe0 m\u1ed9t hook \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng t\u1eeb ",(0,i.jsx)(n.code,{children:"useQuery()"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"c\xfa-ph\xe1p-c\u1ee7a-useinfinitequery",children:"C\xfa ph\xe1p c\u1ee7a useInfiniteQuery()"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const myInfiniteQuery = useInfiniteQuery({\n  /* C\u1ea5u h\xecnh cho useInfiniteQuery() */\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"c\xe1c-thu\u1ed9c-t\xednh-ph\u01b0\u01a1ng-th\u1ee9c-tr\u1ea3-v\u1ec1-t\u1eeb-useinfinitequery",children:"C\xe1c thu\u1ed9c t\xednh, ph\u01b0\u01a1ng th\u1ee9c tr\u1ea3 v\u1ec1 t\u1eeb useInfiniteQuery()"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["V\xec ",(0,i.jsx)(n.code,{children:"useInfiniteQuery()"})," l\xe0 m\u1ed9t hook \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng t\u1eeb ",(0,i.jsx)(n.code,{children:"useQuery()"})," n\xean n\xf3 s\u1ebd c\xf3 t\u1ea5t c\u1ea3 c\xe1c thu\u1ed9c t\xednh / ph\u01b0\u01a1ng th\u1ee9c tr\u1ea3 v\u1ec1 t\u1eeb ",(0,i.jsx)(n.code,{children:"useQuery()"})," . Nh\u01b0ng c\xf3 m\u1ed9t s\u1ed1 kh\xe1c bi\u1ec7t sau:"]}),"\n"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Return value"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"data"})}),(0,i.jsxs)(n.td,{children:["V\xec ",(0,i.jsx)(n.code,{children:"useInfiniteQuery()"})," kh\xf4ng fetch h\u1ebft to\xe0n b\u1ed9 d\u1eef li\u1ec7u m\u1ed9t l\xfac m\xe0 n\xf3 fetch t\u1eebng b\u1ed9 d\u1eef li\u1ec7u m\u1ed9t (m\u1ed9t b\u1ed9 c\xf3 th\u1ec3 c\xf3 5, 10 ph\u1ea7n t\u1eed t\xf9y ta ch\u1ec9 \u0111\u1ecbnh).",(0,i.jsx)("br",{}),"Thu\u1ed9c t\xednh ",(0,i.jsx)(n.code,{children:"data.pages"})," tr\u1ea3 v\u1ec1 m\u1ed9t m\u1ea3ng ch\u1ee9a t\u1ea5t c\u1ea3 c\xe1c b\u1ed9 \u0111\xe3 fetch \u0111\u01b0\u1ee3c cho \u0111\u1ebfn hi\u1ec7n t\u1ea1i, m\u1ed7i ph\u1ea7n t\u1eed (b\u1ed9) l\u1ea1i l\xe0 m\u1ed9t m\u1ea3ng ch\u1ee9a c\xe1c item l\xe0 d\u1eef li\u1ec7u c\u1ea7n render"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"hasNextPage"})}),(0,i.jsxs)(n.td,{children:["Tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"true"})," n\u1ebfu c\xf2n fetch xu\xf4i th\xeam \u0111\u01b0\u1ee3c n\u1eefa c\xe1c b\u1ed9 d\u1eef li\u1ec7u"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"hasPreviousPage"})}),(0,i.jsxs)(n.td,{children:["Tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"true"})," n\u1ebfu c\xf2n fetch ng\u01b0\u1ee3c th\xeam \u0111\u01b0\u1ee3c n\u1eefa c\xe1c b\u1ed9 d\u1eef li\u1ec7u"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"isFetchingNextPage"})}),(0,i.jsxs)(n.td,{children:["Tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"true"})," n\u1ebfu \u0111ang th\u1ef1c hi\u1ec7n vi\u1ec7c fetch xu\xf4i b\u1ed9 d\u1eef li\u1ec7u m\u1edbi"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"isFetchingPreviousPage"})}),(0,i.jsxs)(n.td,{children:["Tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"true"})," n\u1ebfu \u0111ang th\u1ef1c hi\u1ec7n vi\u1ec7c fetch ng\u01b0\u1ee3c b\u1ed9 d\u1eef li\u1ec7u m\u1edbi"]})]})]})]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Method"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"fetchNextPage()"})}),(0,i.jsx)(n.td,{children:"D\xf9ng \u0111\u1ec3 trigger fetch xu\xf4i th\xeam b\u1ed9 d\u1eef li\u1ec7u"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"fetchPreviousPage()"})}),(0,i.jsx)(n.td,{children:"D\xf9ng \u0111\u1ec3 trigger fetch ng\u01b0\u1ee3c th\xeam b\u1ed9 d\u1eef li\u1ec7u"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"c\u1ea5u-h\xecnh-cho-useinfinitequery",children:"C\u1ea5u h\xecnh cho useInfiniteQuery()"}),"\n",(0,i.jsxs)(n.p,{children:["V\xec ",(0,i.jsx)(n.code,{children:"useInfiniteQuery()"})," l\xe0 m\u1ed9t hook \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng t\u1eeb ",(0,i.jsx)(n.code,{children:"useQuery()"})," n\xean n\xf3 s\u1ebd c\xf3 c\u1ea5u h\xecnh t\u01b0\u01a1ng t\u1ef1 nh\u01b0 ",(0,i.jsx)(n.code,{children:"useQuery()"})," . Nh\u01b0ng c\xf3 m\u1ed9t s\u1ed1 kh\xe1c bi\u1ec7t sau:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Config"}),(0,i.jsx)(n.th,{children:"Value"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"queryFn"})}),(0,i.jsx)(n.td,{children:"Function"}),(0,i.jsxs)(n.td,{children:["\u27a1\ufe0fNh\u1eadn m\u1ed9t function",(0,i.jsx)(n.strong,{children:"return Promise"}),": ",(0,i.jsx)(n.code,{children:"queryFn: ({ pageParam }) => {\u2026}"}),(0,i.jsx)("br",{}),"\u27a1\ufe0fNgo\xe0i c\xe1c parameter detsructuring nh\u01b0 ",(0,i.jsx)(n.code,{children:"queryKey"}),", ",(0,i.jsx)(n.code,{children:"signal"})," nh\u01b0 \u1edf ",(0,i.jsx)(n.code,{children:"queryFn"})," trong ",(0,i.jsx)(n.code,{children:"useQuery()"}),", c\xf2n c\xf3 th\xeam ",(0,i.jsx)(n.code,{children:"pageParams"})," l\xe0 s\u1ed1 th\u1ee9 t\u1ef1 c\u1ee7a page (b\u1ed9) \u0111\u1ec3 fetch"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"initialPageParam"})}),(0,i.jsx)(n.td,{children:"Number"}),(0,i.jsxs)(n.td,{children:["Th\u01b0\u1eddng l\xe0 1 (l\xe0 gi\xe1 tr\u1ecb kh\u1edfi t\u1ea1o c\u1ee7a ",(0,i.jsx)(n.code,{children:"pageParam"})," trong ",(0,i.jsx)(n.code,{children:"queryFn"})," tr\xean)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"getNextPageParam"})}),(0,i.jsx)(n.td,{children:"Function"}),(0,i.jsxs)(n.td,{children:["\u27a1\ufe0f",(0,i.jsx)(n.code,{children:"getNextPageParam: (lastPage, allPages, lastPageParam) => {}"}),(0,i.jsx)("br",{}),"\u270f\ufe0f\xa0",(0,i.jsx)(n.code,{children:"lastPage"}),": l\xe0 b\u1ed9 cu\u1ed1i c\xf9ng \u0111\xe3 \u0111\u01b0\u1ee3c fetch, l\xe0 m\u1ed9t m\u1ea3ng ch\u1ee9a c\xe1c ph\u1ea7n t\u1eed l\xe0 object\xa0d\u1eef li\u1ec7u.",(0,i.jsx)("br",{}),"\u270f\ufe0f\xa0",(0,i.jsx)(n.code,{children:"allPages"}),": l\xe0 m\u1ed9t m\u1ea3ng ch\u1ee9a t\u1ea5t c\u1ea3 c\xe1c b\u1ed9 \u0111\xe3 fetch \u0111\u01b0\u1ee3c.",(0,i.jsx)("br",{}),"\u270f\ufe0f",(0,i.jsx)(n.code,{children:"lastPageParam"}),": l\xe0 m\u1ed9t number l\xe0 s\u1ed1 th\u1ee9 t\u1ef1\xa0page (b\u1ed9) cu\u1ed1i c\xf9ng \u0111\xe3 fetch \u0111\u01b0\u1ee3c",(0,i.jsx)("br",{}),"\u27a1\ufe0fL\xe0 m\u1ed9t h\xe0m return v\u1ec1 m\u1ed9t ",(0,i.jsx)(n.code,{children:"number"})," l\xe0 s\u1ed1 th\u1ee9 t\u1ef1 page (b\u1ed9) ti\u1ebfp theo c\u1ea7n fetch theo th\u1ee9 t\u1ef1 xu\xf4i.\xa0",(0,i.jsx)("br",{}),"\u27a1\ufe0fN\u1ebfu tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"undefined"}),", s\u1ebd kh\xf4ng fetch th\xeam b\u1ed9 n\xe0o n\u1eefa, v\xe0 l\xfac \u0111\xf3 thu\u1ed9c t\xednh ",(0,i.jsx)(n.code,{children:"hasNextPage"})," s\u1ebd tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"false"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"getPreviousPageParam"})}),(0,i.jsx)(n.td,{children:"Function"}),(0,i.jsxs)(n.td,{children:["\u27a1\ufe0f",(0,i.jsx)(n.code,{children:"getPreviousPageParam: (firstPage, allPages, firstPageParam) => {}"}),(0,i.jsx)("br",{}),"\u270f\ufe0f\xa0",(0,i.jsx)(n.code,{children:"firstPage"}),": l\xe0 b\u1ed9 cu\u1ed1i c\xf9ng \u0111\xe3 \u0111\u01b0\u1ee3c fetch theo chi\u1ec1u ng\u01b0\u1ee3c l\u1ea1i, l\xe0 m\u1ed9t m\u1ea3ng ch\u1ee9a\xa0c\xe1c ph\u1ea7n t\u1eed l\xe0 object\xa0d\u1eef li\u1ec7u.",(0,i.jsx)("br",{}),"\u270f\ufe0f\xa0",(0,i.jsx)(n.code,{children:"allPages"}),": l\xe0 m\u1ed9t m\u1ea3ng ch\u1ee9a t\u1ea5t c\u1ea3 c\xe1c b\u1ed9 \u0111\xe3 fetch \u0111\u01b0\u1ee3c.",(0,i.jsx)("br",{}),"\u270f\ufe0f",(0,i.jsx)(n.code,{children:"firstPageParam"}),": l\xe0 m\u1ed9t number l\xe0 s\u1ed1 page (b\u1ed9) cu\u1ed1i c\xf9ng \u0111\xe3 fetch \u0111\u01b0\u1ee3c theo chi\u1ec1u ng\u01b0\u1ee3c l\u1ea1i",(0,i.jsx)("br",{}),"\u27a1\ufe0fL\xe0 m\u1ed9t h\xe0m return v\u1ec1 m\u1ed9t ",(0,i.jsx)(n.code,{children:"number"})," l\xe0 s\u1ed1 th\u1ee9 t\u1ef1 page (b\u1ed9) ti\u1ebfp theo c\u1ea7n fetch theo th\u1ee9 t\u1ef1 ng\u01b0\u1ee3c l\u1ea1i.",(0,i.jsx)("br",{}),"\u27a1\ufe0fN\u1ebfu tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"undefined"}),", s\u1ebd kh\xf4ng fetch th\xeam b\u1ed9 n\xe0o n\u1eefa, v\xe0 l\xfac \u0111\xf3 thu\u1ed9c t\xednh ",(0,i.jsx)(n.code,{children:"hasPreviousPage"})," s\u1ebd tr\u1ea3 v\u1ec1 ",(0,i.jsx)(n.code,{children:"false"})]})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"v\xed-d\u1ee5",children:"V\xed d\u1ee5:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:'import { useInfiniteQuery } from "@tanstack/react-query";\nimport axios from "axios";\n\ninterface Task {\n  name: string;\n}\n\ninterface TaskResponse {\n  currentPage: number;\n  totalPages: number;\n  hasNextPage: boolean;\n  pageSize: number;\n  data: Task[];\n}\n\nconst http = axios.create({\n  baseURL: "https://6404cc9280d9c5c7bad0e2f2.mockapi.io/api/v1/",\n});\n\nconst httpGetByPage = async (page: number) => {\n  //Gi\u1edbi h\u1ea1n m\u1ed7i b\u1ed9 ch\u1ee9a 5 item c\u1ea7n render\n  const { data } = await http.get<TaskResponse>(`tasks?page=${page}&limit=5`);\n  return data;\n};\n\nexport default function App() {\n  const { data, fetchNextPage, hasNextPage, isFetchingNextPage } =\n    useInfiniteQuery({\n      queryKey: ["tasks"],\n      queryFn: ({ pageParam }) => httpGetByPage(pageParam),\n      initialPageParam: 1,\n      getNextPageParam: (lastPage, allPages) => {\n        /* \n          lastPage: TaskResponse\n          allPages: TaskResponse[]\n        */\n        return lastPage.hasNextPage ? lastPage.currentPage + 1 : undefined;\n      },\n    });\n\n  return (\n    <div>\n      {data?.pages.map((page) => (\n        <>\n          {page.data.map((task, index) => (\n            <p key={index}>{task.name}</p>\n          ))}\n        </>\n      ))}\n      <button\n        onClick={() => fetchNextPage()}\n        disabled={!hasNextPage || isFetchingNextPage}\n      >\n        Load more\n      </button>\n    </div>\n  );\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>h});var c=t(6540);const i={},r=c.createContext(i);function s(e){const n=c.useContext(r);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function h(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);