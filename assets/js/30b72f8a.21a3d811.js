"use strict";(self.webpackChunkreactjs=self.webpackChunkreactjs||[]).push([[486],{2773:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>c,metadata:()=>h,toc:()=>o});var r=e(4848),i=e(8453);const c={sidebar_position:5},s="useMutation()",h={id:"useMutation",title:"useMutation()",description:"useMutation() l\xe0 g\xec?",source:"@site/docs/useMutation.md",sourceDirName:".",slug:"/useMutation",permalink:"/react-query/useMutation",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"useQueries()",permalink:"/react-query/useQueries"},next:{title:"Infinite scroll v\u1edbi useInfiniteQuery()",permalink:"/react-query/infinite-scroll"}},d={},o=[{value:"useMutation() l\xe0 g\xec?",id:"usemutation-l\xe0-g\xec",level:2},{value:"C\xfa ph\xe1p c\u1ee7a useMutation()",id:"c\xfa-ph\xe1p-c\u1ee7a-usemutation",level:2},{value:"C\xe1c thu\u1ed9c t\xednh, ph\u01b0\u01a1ng th\u1ee9c tr\u1ea3 v\u1ec1 t\u1eeb useMutation()",id:"c\xe1c-thu\u1ed9c-t\xednh-ph\u01b0\u01a1ng-th\u1ee9c-tr\u1ea3-v\u1ec1-t\u1eeb-usemutation",level:2},{value:"C\u1ea5u h\xecnh cho useMutation()",id:"c\u1ea5u-h\xecnh-cho-usemutation",level:2},{value:"V\xed d\u1ee5 v\u1ec1 useMutation()",id:"v\xed-d\u1ee5-v\u1ec1-usemutation",level:2},{value:"\ud83c\udd98\ud83c\udd98\ud83c\udd98L\u01b0u \xfd:",id:"l\u01b0u-\xfd",level:2}];function a(n){const t={code:"code",h1:"h1",h2:"h2",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"usemutation",children:"useMutation()"}),"\n",(0,r.jsx)(t.h2,{id:"usemutation-l\xe0-g\xec",children:"useMutation() l\xe0 g\xec?"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"useMutation()"})," l\xe0 m\u1ed9t hook ph\u1ee5c v\u1ee5 cho vi\u1ec7c g\u1eedi y\xeau c\u1ea7u ",(0,r.jsx)(t.strong,{children:"POST"})," , ",(0,r.jsx)(t.strong,{children:"PUT"})," , ",(0,r.jsx)(t.strong,{children:"DELETE"})," d\u1eef li\u1ec7u l\xean tr\xean server"]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"c\xfa-ph\xe1p-c\u1ee7a-usemutation",children:"C\xfa ph\xe1p c\u1ee7a useMutation()"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-ts",children:"const myMutation = useMutation({\n  /* C\u1ea5u h\xecnh cho useMutation() */\n});\n"})}),"\n",(0,r.jsx)(t.h2,{id:"c\xe1c-thu\u1ed9c-t\xednh-ph\u01b0\u01a1ng-th\u1ee9c-tr\u1ea3-v\u1ec1-t\u1eeb-usemutation",children:"C\xe1c thu\u1ed9c t\xednh, ph\u01b0\u01a1ng th\u1ee9c tr\u1ea3 v\u1ec1 t\u1eeb useMutation()"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Property"}),(0,r.jsx)(t.th,{children:"Return value"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"status"})}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"pending"}),": n\u1ebfu mutation \u0111ang th\u1ef1c thi (t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ",(0,r.jsx)(t.code,{children:"isPending"}),")",(0,r.jsx)("br",{}),(0,r.jsx)(t.code,{children:"success"}),": n\u1ebfu mutation th\u1ef1c thi th\xe0nh c\xf4ng\xa0(t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ",(0,r.jsx)(t.code,{children:"isSuccess"}),")",(0,r.jsx)("br",{}),(0,r.jsx)(t.code,{children:"error"}),": n\u1ebfu mutation th\u1ef1c thi th\u1ea5t b\u1ea1i\xa0(t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi ",(0,r.jsx)(t.code,{children:"isError"}),")"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"data"})}),(0,r.jsx)(t.td,{children:"Tr\u1ea3 v\u1ec1 d\u1eef li\u1ec7u nh\u1eadn \u0111\u01b0\u1ee3c v\u1ec1 t\u1eeb server sau khi mutation th\u1ef1c thi th\xe0nh c\xf4ng"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"error"})}),(0,r.jsx)(t.td,{children:"Tr\u1ea3 v\u1ec1 l\u1ed7i m\xe0 server ph\u1ea3n h\u1ed3i khi mutation th\u1ef1c thi th\u1ea5t b\u1ea1i"})]})]})]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Method"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"mutate()"})}),(0,r.jsxs)(t.td,{children:["\u27a1\ufe0fD\xf9ng \u0111\u1ec3 trigger request (",(0,r.jsx)(t.strong,{children:"POST"})," , ",(0,r.jsx)(t.strong,{children:"PUT"})," , ",(0,r.jsx)(t.strong,{children:"DELETE"})," ).",(0,r.jsx)("br",{}),"\u27a1\ufe0fC\xfa ph\xe1p: ",(0,r.jsx)(t.code,{children:"mutate(variables, { onSuccess: (data) => {}, onError: (error) => {} });"}),(0,r.jsx)("br",{}),"\u270f\ufe0f",(0,r.jsx)(t.code,{children:"variables"}),": parameter \u0111\u1ec3 truy\u1ec1n v\xe0o mutation function (\u0111\xe2y c\xf3 th\u1ec3 l\xe0 d\u1eef li\u1ec7u ph\u1ea7n body c\u1ee7a request). N\u1ebfu c\xf3 nhi\u1ec1u parameter mu\u1ed1n truy\u1ec1n v\xe0o mutation function, ph\u1ea3i g\xf3i l\u1ea1i trong m\u1ed9t object v\xec \u0111\xe2y l\xe0 bi\u1ebfn \u0111\u01a1n",(0,r.jsx)("br",{}),"\u270f\ufe0f",(0,r.jsx)(t.code,{children:"data"}),": d\u1eef li\u1ec7u nh\u1eadn \u0111\u01b0\u1ee3c t\u1eeb server sau khi mutation th\u1ef1c thi th\xe0nh c\xf4ng, n\xf3 ch\xednh l\xe0 thu\u1ed9c t\xednh ",(0,r.jsx)(t.code,{children:"data"})," tr\u1ea3 v\u1ec1 t\u1eeb ",(0,r.jsx)(t.code,{children:"useMutation()"}),(0,r.jsx)("br",{}),"\u270f\ufe0f",(0,r.jsx)(t.code,{children:"error"}),": l\u1ed7i m\xe0 server tr\u1ea3 v\u1ec1 sau khi mutation th\u1ef1c thi th\u1ea5t b\u1ea1i, n\xf3 ch\xednh l\xe0 thu\u1ed9c t\xednh ",(0,r.jsx)(t.code,{children:"error"})," tr\u1ea3 v\u1ec1 t\u1eeb ",(0,r.jsx)(t.code,{children:"useMutation()"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"mutateAsync()"})}),(0,r.jsxs)(t.td,{children:["C\u1ea5u h\xecnh gi\u1ed1ng nh\u01b0 ",(0,r.jsx)(t.code,{children:"mutate()"}),". Ch\u1ec9 kh\xe1c ",(0,r.jsx)(t.code,{children:"mutate()"})," tr\u1ea3 v\u1ec1 ki\u1ec3u void n\xean kh\xf4ng th\u1ec3 d\xf9ng ",(0,r.jsx)(t.code,{children:"await"}),", c\xf2n ",(0,r.jsx)(t.code,{children:"mutateAsync()"})," tr\u1ea3 v\u1ec1 m\u1ed9t ",(0,r.jsx)(t.strong,{children:"Promise"})," n\xean c\xf3 th\u1ec3 s\u1eed d\u1ee5ng k\xe8m v\u1edbi t\u1eeb kh\xf3a ",(0,r.jsx)(t.code,{children:"await"})," \u0111\u1ec3 ch\u1edd \u0111\u1ee3i mutation th\u1ef1c thi xong"]})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"c\u1ea5u-h\xecnh-cho-usemutation",children:"C\u1ea5u h\xecnh cho useMutation()"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Config"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"mutationFn"})}),(0,r.jsx)(t.td,{children:"Function"}),(0,r.jsxs)(t.td,{children:["Nh\u1eadn v\xe0o m\u1ed9t function ",(0,r.jsx)(t.code,{children:"return Promise"})," \u0111\u1ec3 th\u1ef1c hi\u1ec7n vi\u1ec7c g\u1eedi request l\xean server"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"onMutate"})}),(0,r.jsx)(t.td,{children:"Function"}),(0,r.jsxs)(t.td,{children:["\u27a1\ufe0fNh\u1eadn v\xe0o m\u1ed9t function c\xf3 parameter l\xe0 ",(0,r.jsx)(t.code,{children:"variables"}),": ",(0,r.jsx)(t.code,{children:"onMutate: (variables) => {}"}),(0,r.jsx)("br",{}),"\u27a1\ufe0fParameter ",(0,r.jsx)(t.code,{children:"variables"})," l\xe0 tham s\u1ed1 th\u1ee9 nh\u1ea5t truy\u1ec1n v\xe0o \u1edf h\xe0m ",(0,r.jsx)(t.strong,{children:"mutate()"})," \u1edf b\xean tr\xean.",(0,r.jsx)("br",{}),"\u27a1\ufe0fH\xe0m n\xe0y \u0111\u01b0\u1ee3c g\u1ecdi tr\u01b0\u1edbc khi mutation \u0111\u01b0\u1ee3c th\u1ef1c thi. H\xe0m n\xe0y tr\u1ea3 v\u1ec1 m\u1ed9t Promise n\xean c\xf3 th\u1ec3 \u0111i k\xe8m v\u1edbi async/await."]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"onSuccess"})}),(0,r.jsx)(t.td,{children:"Function"}),(0,r.jsxs)(t.td,{children:["\u27a1\ufe0fNh\u1eadn v\xe0o m\u1ed9t function c\xf3 parameter l\xe0 ",(0,r.jsx)(t.code,{children:"data"}),": ",(0,r.jsx)(t.code,{children:"onSuccess: (data) => {}"}),(0,r.jsx)("br",{}),"\u27a1\ufe0fParameter ",(0,r.jsx)(t.code,{children:"data"})," c\u0169ng ch\xednh l\xe0 thu\u1ed9c t\xednh ",(0,r.jsx)(t.code,{children:"data"})," \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 t\u1eeb ",(0,r.jsx)(t.code,{children:"useMutation()"}),(0,r.jsx)("br",{}),"\u27a1\ufe0fH\xe0m \u0111\u01b0\u1ee3c g\u1ecdi ngay sau khi mutation th\u1ef1c thi th\xe0nh c\xf4ng.",(0,r.jsx)("br",{}),"\u27a1\ufe0fH\xe0m n\xe0y tr\u1ea3 v\u1ec1 ",(0,r.jsx)(t.code,{children:"Promise"})," n\xean c\xf3 th\u1ec3 \u0111i k\xe8m v\u1edbi ",(0,r.jsx)(t.code,{children:"await"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"onError"})}),(0,r.jsx)(t.td,{children:"Function"}),(0,r.jsxs)(t.td,{children:["\u27a1\ufe0fL\xe0 m\u1ed9t function nh\u1eadn ",(0,r.jsx)(t.code,{children:"error"})," (c\xf3 th\u1ec3 l\xe0 ",(0,r.jsx)(t.code,{children:"AxiosError"}),") l\xe0m parameter: ",(0,r.jsx)(t.code,{children:"onError: (error) => {}"}),(0,r.jsx)("br",{}),"\u27a1\ufe0fParameter ",(0,r.jsx)(t.code,{children:"error"})," c\u0169ng ch\xednh l\xe0 thu\u1ed9c t\xednh ",(0,r.jsx)(t.code,{children:"error"})," \u0111\u01b0\u1ee3c tr\u1ea3 v\u1ec1 t\u1eeb ",(0,r.jsx)(t.code,{children:"useMutation()"}),".",(0,r.jsx)("br",{}),"\u27a1\ufe0fH\xe0m s\u1ebd ch\u1ea1y ngay sau khi c\xf3 l\u1ed7i ph\xe1t sinh trong khi mutation th\u1ef1c thi.",(0,r.jsx)("br",{}),"\u27a1\ufe0fH\xe0m n\xe0y tr\u1ea3 v\u1ec1 ",(0,r.jsx)(t.code,{children:"Promise"})," n\xean c\xf3 th\u1ec3 \u0111i k\xe8m v\u1edbi ",(0,r.jsx)(t.code,{children:"await"})]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"retry"})}),(0,r.jsx)(t.td,{children:"Number"}),(0,r.jsx)(t.td,{children:"Mutation s\u1ebd th\u1ef1c thi l\u1ea1i t\u1ed1i \u0111a s\u1ed1 l\u1ea7n ta ch\u1ec9 \u0111\u1ecbnh n\u1ebfu server ph\u1ea3n h\u1ed3i l\u1ed7i. Sau s\u1ed1 l\u1ea7n retry n\xe0y n\u1ebfu server v\u1eabn ph\u1ea3n h\u1ed3i l\u1ea1i l\u1ed7i th\xec l\xfac \u0111\xf3 m\u1edbi th\u1ef1c s\u1ef1 g\u1eedi l\u1ed7i v\u1ec1 client"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"retryDelay"})}),(0,r.jsx)(t.td,{children:"Number"}),(0,r.jsx)(t.td,{children:"Ch\u1ec9 \u0111\u1ecbnh th\u1eddi gian delay gi\u1eefa c\xe1c l\u1ea7n retry."})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"v\xed-d\u1ee5-v\u1ec1-usemutation",children:"V\xed d\u1ee5 v\u1ec1 useMutation()"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:'import axios, { AxiosError } from "axios";\nimport { useMutation } from "@tanstack/react-query";\nimport { useRef } from "react";\n\nconst http = axios.create({\n  baseURL: "https://6404cc9280d9c5c7bad0e2f2.mockapi.io/api/v1/",\n});\n\ninterface Task {\n  name: string;\n}\n\nconst httpPost = async (body: Task) => {\n  const { data } = await http.post<Task>("tasks", body);\n  return data;\n};\n\nexport default function App() {\n  const inputRef = useRef<HTMLInputElement>(null);\n  const postTaskMutation = useMutation({\n    mutationFn: httpPost,\n    onSuccess: (data) => {\n      console.log(data);\n    },\n    onError: (error: AxiosError) => {\n      console.log(error);\n    },\n  });\n  return (\n    <>\n      <input ref={inputRef} />\n      <button\n        onClick={() =>\n          postTaskMutation.mutate({ name: inputRef.current?.value as string })\n        }\n      >\n        Add new task\n      </button>\n    </>\n  );\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"l\u01b0u-\xfd",children:"\ud83c\udd98\ud83c\udd98\ud83c\udd98L\u01b0u \xfd:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["N\u1ebfu ta truy\u1ec1n tr\u1ef1c ti\u1ebfp \u0111\u1ed1i t\u01b0\u1ee3ng function v\xe0o ",(0,r.jsx)(t.code,{children:"mutationFn"})," th\xec function \u0111\xf3 ch\u1ec9 nh\u1eadn ",(0,r.jsx)(t.strong,{children:"M\u1ed8T"})," parameter duy nh\u1ea5t v\xe0 \u0111\u1ed1i s\u1ed1 \u0111\u01b0\u1ee3c truy\u1ec1n cho parameter duy nh\u1ea5t \u0111\xf3 ch\xednh l\xe0 gi\xe1 tr\u1ecb c\u1ee7a ",(0,r.jsx)(t.code,{children:"variables"})," \u1edf ph\u01b0\u01a1ng th\u1ee9c ",(0,r.jsx)(t.code,{children:"mutate()"}),". V\xed d\u1ee5:"]}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:'interface Task {\n  name: string;\n  deadline: Date;\n}\n\nconst http = axios.create({\n  baseURL: "https://6404cc9280d9c5c7bad0e2f2.mockapi.io/api/v1/",\n});\n\nconst httpPost = async (body: Task) => {\n  const { data } = await http.post<Task>("tasks", body);\n  return data;\n};\n\nconst postTaskMutation = useMutation({\n  mutationFn: httpPost, //Truy\u1ec1n tr\u1ef1c ti\u1ebfp \u0111\u1ed1i t\u01b0\u1ee3ng function, th\xec function n\xe0y ch\u1ec9 c\xf3 M\u1ed8T parameter duy nh\u1ea5t\n});\n\nconst handlePostTask = () => {\n  updateTaskMutation.mutate(\n    { name: "X", deadline: new Date() },\n    {\n      onSuccess: (data) => {},\n      onError: (error: AxiosError) => {\n        console.log(error);\n      },\n    }\n  );\n};\n'})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:["N\u1ebfu mu\u1ed1n \u0111\u1ed1i t\u01b0\u1ee3ng function c\u1ee7a ",(0,r.jsx)(t.code,{children:"mutationFn"})," c\xf3 t\u1eeb hai parameter tr\u1edf l\xean (nh\u01b0 ph\u01b0\u01a1ng th\u1ee9c ",(0,r.jsx)(t.strong,{children:"PUT"})," c\u1ea7n ",(0,r.jsx)(t.code,{children:"id"})," v\xe0 ",(0,r.jsx)(t.code,{children:"body"}),"), th\xec ta ph\u1ea3i truy\u1ec1n function \u0111\xf3 d\u01b0\u1edbi d\u1ea1ng callback. L\xfac n\xe0y cho ",(0,r.jsx)(t.code,{children:"variables"})," \u1edf ph\u01b0\u01a1ng th\u1ee9c ",(0,r.jsx)(t.code,{children:"mutate()"})," b\u1eb1ng ",(0,r.jsx)(t.code,{children:"undefined"}),". V\xed d\u1ee5:"]}),"\n"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-tsx",children:'const http = axios.create({\n  baseURL: "https://6404cc9280d9c5c7bad0e2f2.mockapi.io/api/v1/",\n});\n\nconst httpPut = async (id: number, body: Task) => {\n  const { data } = await http.put<Task>(`tasks/${id}`, body);\n  return data;\n};\n\nconst updateTaskMutation = useMutation({\n  mutationFn: () => httpPut(reqId, reqData), // Truy\u1ec1n mutation function d\u01b0\u1edbi d\u1ea1ng callback\n});\nconst handleUpdateTask = () => {\n  //Ch\u1ec9 \u0111\u1ecbnh gi\xe1 tr\u1ecb c\u1ee7a variables th\xe0nh "undefined" do kh\xf4ng d\xf9ng \u0111\u1ebfn\n  updateTaskMutation.mutate(undefined, {\n    onSuccess: (data) => {},\n    onError: (error: AxiosError) => {\n      console.log(error);\n    },\n  });\n};\n'})})]})}function u(n={}){const{wrapper:t}={...(0,i.R)(),...n.components};return t?(0,r.jsx)(t,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},8453:(n,t,e)=>{e.d(t,{R:()=>s,x:()=>h});var r=e(6540);const i={},c=r.createContext(i);function s(n){const t=r.useContext(c);return r.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function h(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),r.createElement(c.Provider,{value:t},n.children)}}}]);